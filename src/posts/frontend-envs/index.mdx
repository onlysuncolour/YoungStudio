---
title: "前端竟然还需要更多的容器去发布？"
date: "2024-04-15"
spoiler: "当运维跟我说“xx云上的容器都用完了，没有多余的给你发布”时，我震惊了。"
---

## 背景

当然，那时候的我司，还没有运维。管理xx云上容器的还都是测试同学。

彼时，当然现在也是，秉持着前端、后端、数据库等都在一个xx云镜像里面。对于一些纯前端的需求或是bug-fix来说，发布部署也需要一个完整的阿里云镜像。  
还有一个小原因是，彼时(当然现在也是)的我司，在倡导开员节流，xx云上的docker数量也有些捉襟见肘。  

当然，还有一个大原因是，出现了bug，由于数据原因，并不能很轻松的在测试环境复现bug；解决完bug后，也并不能很好的确认是否真的解决掉客户/线上的问题，总不能发到客户/线上之后再测一遍吧。

对于我本人来说，理解上就是简单的把前端部署在随便的一个地方，改一下nginx就可以随便访问了。  

但是，由于没有专业的运维，除了前端以外他人也都不太在意这件事儿(等其他同学释放docker环境就好了嘛)，我还是决定出手了。

下面就是设想中的任务流。


## 任务流

1. 打包部署到服务器。不同任务部署的文件路径不同。
2. 所有frontend-xxx.corp.com的域名都解析到该服务器。
3. 该服务器配置nginx，server_name用regex实现都访问同一端口
4. 实现nodejs服务端，根据hostname，访问不同文件路径
5. nodejs开放api，实现不同hostname可以访问不同后端环境。

## END

彼时在我司，做业务方向的前端同学8个，测试同学4个。  
这个功能上线一年，共计有任务260多次，部署1200多次。  
虽然这个功能很小，也还是很有成就感。  